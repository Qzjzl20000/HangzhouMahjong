# 杭州麻将计分器

一个轻量级的杭州麻将计分工具，采用纯前端技术实现，数据本地存储。

## 功能特性

- 支持 4 人麻将游戏计分
- 自动计算每位玩家的盈亏
- 显示庄家状态和连庄信息（区分连庄数和老庄状态）
- 历史记录瀑布流展示
- 游戏重置功能
- 投掷骰子工具（2枚骰子，独立功能）
- 数据本地存储，刷新页面不丢失
- 支持导出/导入游戏数据

## 技术栈

- 纯 HTML/CSS/JavaScript
- LocalStorage 数据存储
- 响应式设计，适配桌面和移动端

## 项目结构

```
HangzhouMahjong/
├── index.html              # 主页面
├── css/
│   ├── reset.css          # 样式重置
│   └── style.css          # 主样式
├── js/
│   ├── app.js             # 主逻辑
│   ├── game.js            # 游戏状态管理
│   ├── score.js           # 计分算法
│   ├── ui.js              # 界面渲染
│   ├── dice.js            # 骰子功能
│   └── storage.js         # 数据持久化
├── assets/
│   └── images/            # 图片资源
├── config/
│   └── rules.json         # 积分规则配置
└── README.md              # 使用说明
```

## 使用方法

### 本地运行

1. 克隆或下载项目
2. 直接用浏览器打开 `index.html` 文件
3. 或使用本地服务器（推荐）：
   ```bash
   # 使用 Python
   python -m http.server 8000

   # 使用 Node.js http-server
   npx http-server
   ```
4. 在浏览器中访问 `http://localhost:8000`

### GitHub Pages 部署

1. 将项目推送到 GitHub 仓库
2. 在仓库设置中启用 GitHub Pages
3. 选择主分支作为发布源
4. 访问 `https://username.github.io/repository-name`

## 游戏流程

1. **初始设置**
   - 输入4位玩家名称
   - 选择首庄
   - 设置初始积分（默认100分）
   - 点击"开始游戏"

2. **游戏进行**
   - 查看玩家积分和状态
   - 选择胡牌玩家和胡牌类型
   - 预览各玩家盈亏
   - 确认记录
   - 系统自动更新积分和庄家状态

3. **骰子工具**
   - 点击"投掷骰子"按钮
   - 查看2枚骰子的点数和总和
   - 用于确定开局庄家位置

4. **历史记录**
   - 查看每局的详细记录
   - 包括胡牌玩家、胡牌类型、积分变化

5. **重新开始**
   - 点击"重新开始"按钮
   - 确认后清空所有数据

## 积分规则

### 计分公式
```
最终得分 = 2^胡牌番数 × 2^庄家番数
```

### 胡牌番数（最大4番）

**基础番型：**
- 平胡（0番）
- 无财平胡（1番）
- 爆头（1番）
- 杠开（1番）
- 无财杠开（2番）
- 双杠开（2番）
- 三杠开（3番）
- 财飘（2番）
- 双财飘（3番）
- 三财飘（4番）
- 七对（2番）
- 无财七对（3番）
- 豪华七对（4番）
- 无财豪七（4番）
- 十风（3番）
- 十风有财（4番）

**叠加番型：**
- 杠爆、双杠爆、三杠爆
- 飘爆、双飘爆、三飘爆
- 杠飘、双杠飘、三杠飘
- 飘杠、双飘杠、三飘杠
- 七对爆头、七对财飘
- 豪七爆头、豪七财飘

### 庄家番数（最大3番）
- 闲家（0番）
- 一老庄（1番）
- 二老庄（2番）
- 三老庄（3番）

### 连庄规则
- 庄家胡牌：继续坐庄，连庄数+1，老庄状态提升
- 闲家胡牌：下家坐庄，连庄数归零，老庄状态归零
- 连庄3次及以上达到三老庄（封顶）

## 自定义规则

可通过修改 `config/rules.json` 文件来自定义积分规则：

```json
{
  "winTypes": {
    "基础番型": [...],
    "叠加番型": [...]
  },
  "bankerLevels": [...],
  "scoring": {
    "maxFan": 4,
    "maxBankerFan": 3
  }
}
```

## 数据管理

### 本地存储
游戏数据自动保存到浏览器 LocalStorage，刷新页面不会丢失。

### 导出数据
未来版本将支持导出游戏记录为 JSON 文件。

### 导入数据
未来版本将支持导入 JSON 文件恢复游戏。

## 浏览器兼容性

- Chrome 60+
- Firefox 60+
- Safari 12+
- Edge 79+

## 开发计划

- [x] 初始设置界面
- [x] 玩家状态显示（含连庄数和老庄状态）
- [x] 计分输入与计算
- [x] 历史记录展示
- [x] 投掷骰子功能
- [x] 庄家轮换逻辑
- [x] 数据持久化
- [x] 重新开始功能
- [x] 响应式适配
- [ ] 界面美化优化
- [ ] 交互动画
- [ ] 数据导出/导入
- [ ] 性能优化
- [ ] PWA 支持
- [ ] 胡牌类型自定义编辑
- [ ] 游戏统计图表

## 许可证

MIT License
